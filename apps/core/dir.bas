BYTE A = 128
BYTE B = 0
BYTE C = 0
BYTE I = 0
BYTE E = 0
STRING FILE[17] = ""
@START
	IF #COM[A] < 33 GOTO OPEN
	LET FILE[I] = #COM[A]
	INC A
	INC I
	IF I > 17 GOTO KILL
	GOTO START
OPEN:
	LET A = 0
	LET I = 1
	IF FILE[3] = 58 GOTO HASFSD
NOFSD:
	LET #COM[I] = 255
	INC I
	IF I < 4 GOTO NOFSD
	LET I = 0
	GOTO READYRE
TODEC:
	LET FILE[A] =- 48
	RETURN
HASFSD:
	IF A = 2 GOSUB TODEC
	LET #COM[I] = FILE[A]
	INC I
	INC A
	IF A < 3 GOTO HASFSD
	LET I = A
	INC I
READYRE:
	LET #COM[4] = 0
READDIR:
	LET #COM[0] = 11
	GOSUB WAIT
	IF #COM[126] > 0 GOTO KILL
	LET #COM[4] =+ 1
	LET I = 128
PENTRY:
	LET C = #COM[I]
	IF C < 33 GOSUB TOSPACE
	GOSUB PUTC
	INC I
	IF I = 136 GOSUB PUTDOT
	IF I = 139 GOTO NEXT
	GOTO PENTRY
NEXT:
	GOSUB PUTSPACE
	LET C = #COM[140]
	GOSUB PRINTB
	LET C = #COM[139]
	GOSUB PRINTB
	GOSUB NEWLINE
	IF #COM[143] = 0 GOTO READDIR
KILL:
	GETPID A
	LET #COM[1] = A
	LET #COM[0] = 255
HALT:
	GOTO HALT
	
	
WAIT:
	FORFIT
	IF #COM[0] > 0 GOTO WAIT
	RETURN
PUTSPACE:
	LET C = 32
PUTC:
	WRITE #SIO,C,E
	IF E > 0 GOTO PERR
	RETURN
PERR:
	FORFIT
	GOTO PUTC
TOSPACE:
	LET C = 32
	RETURN
PUTDOT:
	LET C = 46
	GOTO PUTC
NEWLINE:
	LET C = 10
	GOTO PUTC
PRINTB:
	SPLIT C,B,A
	LET C = A
	GOSUB PRINTH
	LET C = B
	GOTO PRINTH
PRINTH:
	LET C =+ 48
	IF C > 57 GOSUB PRINTH1
	GOSUB PUTC
	RETURN
PRINTH1:
	LET C =+ 7
	RETURN
	